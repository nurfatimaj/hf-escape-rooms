{
  "hash": "1aaa9701b395e1ed0c0c52a72c0b3bd7",
  "result": {
    "engine": "knitr",
    "markdown": "---\nlisting: \n  id: room-table\n  contents: rooms\n  type: table\n  fields: \n    - date\n    - title\n    - city\n    - country\n    - players\n  field-display-names: \n    title: Room\n    city: City\n    country: Country\n    players: Players\nexecute: \n  echo: false\n  warning: false\n  error: false\n---\n\n\n\n```{ojs}\n//| panel: input\n//| classes: bg-white text-dark\n\nviewof year_filter = Inputs.form({\n  beg: Inputs.number([2023, Infinity], {step: 1, label: 'From', placeholder: new Date().getFullYear(), value: 2023}), \n  end: Inputs.number([2023, Infinity], {step: 1, label: 'to', placeholder: new Date().getFullYear(), value: new Date().getFullYear()}), \n}, \n{\n  template: (inputs) => htl.html`<div class=\"row justify-content-between no-gutters\">\n    <div class=\"col\">${inputs.beg}</div>\n    <div class=\"col\">${inputs.end}</div>\n    </div>`\n}); \n```\n\n```{ojs}\n//| panel: fill\n//| dependson: room-table\n\nfiltered = transpose(data).filter(function(d) {\n  return year_filter.beg <= new Date(d.date).getFullYear() && new Date(d.date).getFullYear() <= year_filter.end; \n})\n\nwidth = '100%'; \nheight = '500px'; \n\nroomMap = {\n  // You'll often see Leaflet examples initializing a map like L.map('map'),\n  // which tells the library to look for a div with the id 'map' on the page.\n  // In Observable, we instead create a div from scratch in this cell, so it's\n  // completely self-contained.\n  let container = DOM.element('div', { style: `width:${width};height:${height}` });\n  \n  // Note that I'm yielding the container pretty early here: this allows the\n  // div to be placed on the page. This is important, because Leaflet uses\n  // the div's .offsetWidth and .offsetHeight to size the map. If I were\n  // to only return the container at the end of this method, Leaflet might\n  // get the wrong idea about the map's size.\n  yield container;\n  \n  // Now we create a map object and add a layer to it.\n  let map = L.map(container);\n  let osmLayer = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}@2x.png', {\n      attribution: '&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n  }).addTo(map);\n  \n  var rooms = L.featureGroup(); \n  for (var i = 0; i < filtered.length; i++) {\n    let room = L.marker([filtered[i].lat, filtered[i].long]); \n    room.bindPopup(filtered[i].linked_name); \n    rooms.addLayer(room);\n  }\n  \n  map.addLayer(rooms); \n  map.fitBounds(rooms.getBounds(), {maxZoom: 7});\n}\n```\n\n::: {#room-table}\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script type=\"ojs-define\">\n{\"contents\":[{\"name\":\"data\",\"value\":{\"room\":[\"getaway-room-finlayson-lights\",\"getaway-room-smugglers\",\"the-escape-game-heist\",\"the-escape-game-mission-mars\",\"the-escape-game-prison-break\"],\"title\":[\"Finlaysonin Sähkövalo\",\"Smugglers\",\"The Heist\",\"Mission: Mars\",\"Prison Break\"],\"date\":[\"10 Mar 2024\",\"23 May 2024\",\"20 May 2023\",\"30 Apr 2023\",\"20 May 2023\"],\"long\":[23.7758,23.7758,-93.2401,-93.2401,-93.2401],\"lat\":[61.5001,61.5001,44.8555,44.8555,44.8555],\"company\":[\"Getaway Room Escape\",\"Getaway Room Escape\",\"The Escape Game\",\"The Escape Game\",\"The Escape Game\"],\"path\":[\"rooms/getaway-room-finlayson-lights.qmd\",\"rooms/getaway-room-smugglers.qmd\",\"rooms/the-escape-game-heist.qmd\",\"rooms/the-escape-game-mission-mars.qmd\",\"rooms/the-escape-game-prison-break.qmd\"],\"dt\":[\"2024-03-10 15:45:00\",\"2024-05-23 19:30:00\",\"2023-05-20 11:20:00\",\"2023-04-30 08:40:00\",\"2023-05-20 13:00:00\"],\"linked_name\":[\"<b><a href='rooms/getaway-room-finlayson-lights.qmd' target='_parent'>Finlaysonin Sähkövalo<\\/a><\\/b>\",\"<b><a href='rooms/getaway-room-smugglers.qmd' target='_parent'>Smugglers<\\/a><\\/b>\",\"<b><a href='rooms/the-escape-game-heist.qmd' target='_parent'>The Heist<\\/a><\\/b>\",\"<b><a href='rooms/the-escape-game-mission-mars.qmd' target='_parent'>Mission: Mars<\\/a><\\/b>\",\"<b><a href='rooms/the-escape-game-prison-break.qmd' target='_parent'>Prison Break<\\/a><\\/b>\"]}}]}\n</script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}